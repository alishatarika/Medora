<!DOCTYPE html>
<html>
<head>
    <title>Shop Medicines - Medora</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-dark text-white">
<div class="container my-4">
    <h2 class="text-teal mb-3">ðŸ’Š Online Pharmacy</h2>

    <!-- Search input -->
    <input id="searchInput" class="form-control mb-4" type="text" placeholder="Search medicines..." value="{{query}}">

    <table class="table table-dark table-striped" id="medTable">
        <thead>
            <tr>
                <th>Name</th><th>Category</th><th>Company</th><th>Price</th><th>Action</th>
            </tr>
        </thead>
        <tbody>
        {% for med in medicines %}
            <tr>
                <td>{{med[1]}}</td>
                <td>{{med[2]}}</td>
                <td>{{med[3]}}</td>
                <td>â‚¹{{med[4]}}</td>
                <td>
                    <a href="{{ url_for('add_to_cart', med_id=med[0]) }}" class="btn btn-sm btn-primary">Add to Cart</a>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <a href="{{ url_for('cart') }}" class="btn btn-warning mt-3">ðŸ›’ View Cart</a>
    <a href="{{ url_for('home') }}" class="btn btn-secondary mt-3">â¬… Back to Home</a>
</div>

<script>
const searchInput = document.getElementById("searchInput");
const tableBody = document.querySelector("#medTable tbody");

searchInput.addEventListener("input", function() {
    const query = this.value.trim();

    fetch("/shop_ajax?query=" + encodeURIComponent(query))
        .then(response => response.json())
        .then(data => {
            tableBody.innerHTML = ""; // Clear table
            data.forEach(med => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${med.name}</td>
                    <td>${med.category}</td>
                    <td>${med.company}</td>
                    <td>â‚¹${med.price}</td>
                    <td>
                        <a href="/add_to_cart/${med.id}" class="btn btn-sm btn-primary">Add to Cart</a>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        });
});
</script>

</body>
</html>
